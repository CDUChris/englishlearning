{"version":3,"file":"src_app_conversation_conversation_module_ts.js","mappings":"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","sources":["./src/app/conversation/conversation-routing.module.ts","./src/app/conversation/conversation.module.ts","./src/app/conversation/conversation.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ConversationPage } from './conversation.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ConversationPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ConversationPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ConversationPageRoutingModule } from './conversation-routing.module';\n\nimport { ConversationPage } from './conversation.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ConversationPageRoutingModule\n  ],\n  declarations: [ConversationPage]\n})\nexport class ConversationPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { PageBase } from '../app.page';\nimport { AppStore } from '../app.store';\nimport { LoadingController, NavController, ToastController } from '@ionic/angular';\nimport { ActivatedRoute } from '@angular/router';\nimport { getStorage, ref, listAll } from \"firebase/storage\";\nimport { uploadBytes } from '@firebase/storage';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-conversation',\n  templateUrl: './conversation.page.html',\n  styleUrls: ['./conversation.page.scss'],\n})\nexport class ConversationPage extends PageBase implements OnInit {\n\n  conversations = []\n  conversationsSource = []\n\n  constructor(\n    protected appStore: AppStore,\n    protected navCtrl: NavController,\n    public route: ActivatedRoute,\n    private toastController: ToastController,\n    private loadingController: LoadingController,\n    private router:Router\n  ) {\n    super(appStore, navCtrl, route);\n  }\n\n  ngOnInit() {\n    this.fetchConversations()\n  }\n\n  async fetchConversations() {\n\n    // Create a reference to the file we want to download\n    const storage = getStorage();\n\n    // Get the download URL\n    const listRef = ref(storage, 'conversations');\n\n    // Find all the prefixes and items.\n    listAll(listRef)\n      .then((res) => {\n        this.conversations = this.conversationsSource = res.prefixes.map(item => ({ title: item.name,remembered:localStorage.getItem(`conversation${item.name}`) }));\n      }).catch((error) => {\n        // Uh-oh, an error occurred!\n      });\n  }\n\n  async showLoading() {\n    const loading = await this.loadingController.create({\n      message: '上传中...',\n    });\n\n    await loading.present();\n  }\n  async hideLoading() {\n    await this.loadingController.dismiss();\n  }\n\n  async addFileChange(event) {\n    this.showLoading();\n    const file = event.target.files[0];\n    const fileName = file.name;\n    const fielFloderName = fileName.slice(0, fileName.lastIndexOf('.'));\n\n    const storage = getStorage();\n    const storageRef = ref(storage, 'conversations/' + fielFloderName + '/' + fileName);\n\n    // 'file' comes from the Blob or File API\n    uploadBytes(storageRef, file).then(async (snapshot) => {\n      await this.hideLoading();\n      const toast = await this.toastController.create({\n        message: 'Upload success',\n        duration: 1500,\n        position: 'middle'\n      });\n      await toast.present();\n      this.fetchConversations();\n    });\n\n  }\n\n  onInputChange(e) {\n    const { value } = e.detail || {};\n    this.conversations = this.conversationsSource.filter((conversation) => conversation.title.indexOf(value) != -1)\n  }\n\n  \n  onCheckboxChange(conversation,e){\n    const { title } = conversation;\n    const { detail: { checked } } = e;\n    if (checked) {\n      localStorage.setItem(`conversation${title}`, '1');\n    } else {\n      localStorage.removeItem(`conversation${title}`);\n    }\n  }\n\n  onCheckBoxClick(e){\n    e.stopPropagation()\n  }\n  onBack(){\n    // this.location.back()\n    this.router.navigate(['folder/Inbox'])\n  }\n\n}\n"],"names":[],"sourceRoot":"webpack:///"}