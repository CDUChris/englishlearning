{"version":3,"file":"src_app_word-create_create_module_ts.js","mappings":"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","sources":["./src/app/word-create/create-routing.module.ts","./src/app/word-create/create.module.ts","./src/app/word-create/create.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { WordCreatePage } from './create.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: WordCreatePage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class WordCreatePageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { WordCreatePageRoutingModule } from './create-routing.module';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\n\r\nimport { WordCreatePage } from './create.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    WordCreatePageRoutingModule,\r\n    ReactiveFormsModule,\r\n  ],\r\n  declarations: [WordCreatePage]\r\n})\r\nexport class WordCreatePageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\r\nimport {\r\n  AlertController,\r\n  LoadingController,\r\n  NavController,\r\n} from '@ionic/angular';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { firebaseApp } from 'src/config/firebase';\r\nimport {\r\n  getFirestore,\r\n  getDocs,\r\n  collection,\r\n  setDoc,\r\n  doc,\r\n  getDoc,\r\n  query,\r\n  where,\r\n} from '@firebase/firestore';\r\nimport { PageBase } from '../app.page';\r\nimport { AppStore } from '../app.store';\r\nimport Recorder from 'js-audio-recorder';\r\nimport Player from '../utils/player/player';\r\nimport { encodeWAV } from '../utils/transform/transform';\r\nimport { AppConfig } from '../app.config';\r\n\r\nlet recorder = null;\r\nlet playTimer = null;\r\nlet drawPlayId = null;\r\nlet drawRecordId = null;\r\n\r\n//Tab 2 to add new word to database\r\n@Component({\r\n  selector: 'app-create',\r\n  templateUrl: './create.page.html',\r\n  styleUrls: ['./create.page.scss'],\r\n})\r\nexport class WordCreatePage extends PageBase implements OnInit {\r\n  item: any;\r\n  rec: Recorder;\r\n\r\n  audio: any;\r\n  topic = '';\r\n\r\n  audioFile: File;\r\n  public createWordForm: FormGroup;\r\n\r\n  state = {\r\n    sampleBit: 16,\r\n    sampleRate: 16000,\r\n    numChannel: 1,\r\n    compiling: false,\r\n    isRecording: false, // 是否正在录音\r\n    duration: 0,\r\n    fileSize: 0,\r\n    vol: 0,\r\n  };\r\n\r\n  recordStatusStr = 'none';\r\n  fileUrlData = '';\r\n\r\n  constructor(\r\n  private activeRoute: ActivatedRoute,\r\n    public loadingCtrl: LoadingController,\r\n    public alertCtrl: AlertController,\r\n    formBuilder: FormBuilder,\r\n    public navCtrl: NavController,\r\n    protected appStore: AppStore,\r\n    public route: ActivatedRoute\r\n  ) {\r\n    super(appStore, navCtrl, route);\r\n\r\n    this.createWordForm = formBuilder.group({\r\n      translation: ['', Validators.required],\r\n      mandarin: ['', Validators.required],\r\n      literal: ['', Validators.required],\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.item = this.activeRoute.snapshot.params;\r\n    this.topic = this.item ? this.item.Topic : '';\r\n  }\r\n\r\n  async createWord() {\r\n    const loading = await this.loadingCtrl.create();\r\n\r\n    const translation = this.createWordForm.value.translation;\r\n    const mandarin = this.createWordForm.value.mandarin;\r\n    const literal = this.createWordForm.value.literal;\r\n\r\n    const db = getFirestore(firebaseApp);\r\n    const querySnapshot = await getDocs(collection(db, 'wordList'));\r\n    let id = 0;\r\n    querySnapshot.forEach((doc) => {\r\n      let did = Number(doc.id);\r\n      id = Math.max(id, isNaN(did) ? 0 : did);\r\n    });\r\n\r\n    id++;\r\n    console.log(id, id);\r\n    setDoc(doc(db, 'wordList', '' + id), {\r\n      id: '' + id,\r\n      uid: this.$sess.uid,\r\n      Topic: this.topic,\r\n      Translation: translation,\r\n      Mandarin: mandarin,\r\n      Literal: literal,\r\n      FileUrl: this.fileUrlData,\r\n    }).then(\r\n      () => {\r\n        loading.dismiss().then(() => {\r\n          this.navCtrl.pop();\r\n        });\r\n      },\r\n      (error) => {\r\n        loading.dismiss().then(() => {\r\n          console.error(error);\r\n        });\r\n      }\r\n    );\r\n\r\n    return await loading.present();\r\n  }\r\n\r\n  // 录音开启\r\n  startRecord() {\r\n    this.clearPlay();\r\n\r\n    const config = this.collectData();\r\n\r\n    if (!recorder) {\r\n      recorder = new Recorder(config);\r\n\r\n      recorder.onprocess = function (duration) {\r\n        // this.setState({\r\n        //     duration: duration.toFixed(5),\r\n        // });\r\n        // 推荐使用 onprogress\r\n      };\r\n\r\n      recorder.onprogress = (params: any) => {\r\n        // console.log(recorder.duration);\r\n        // console.log(recorder.fileSize);\r\n\r\n        this.setState({\r\n          duration: params.duration.toFixed(5),\r\n          fileSize: params.fileSize,\r\n          vol: params.vol.toFixed(2),\r\n        });\r\n        // 此处控制数据的收集频率\r\n        if (config.compiling) {\r\n          console.log('音频总数据：', params.data);\r\n        }\r\n      };\r\n\r\n      recorder.onplay = () => {};\r\n      recorder.onpauseplay = () => {};\r\n      recorder.onresumeplay = () => {};\r\n      recorder.onstopplay = () => {};\r\n      recorder.onplayend = () => {\r\n        this.stopDrawPlay();\r\n      };\r\n\r\n      config.compiling &&\r\n        (playTimer = setInterval(() => {\r\n          if (!recorder) {\r\n            return;\r\n          }\r\n\r\n          let newData = recorder.getNextData();\r\n          if (!newData.length) {\r\n            return;\r\n          }\r\n          let byteLength = newData[0].byteLength;\r\n          let buffer = new ArrayBuffer(newData.length * byteLength);\r\n          let dataView = new DataView(buffer);\r\n\r\n          // 数据合并\r\n          for (let i = 0, iLen = newData.length; i < iLen; ++i) {\r\n            for (let j = 0, jLen = newData[i].byteLength; j < jLen; ++j) {\r\n              dataView.setInt8(i * byteLength + j, newData[i].getInt8(j));\r\n            }\r\n          }\r\n\r\n          let a = encodeWAV(\r\n            dataView,\r\n            config.sampleRate,\r\n            config.sampleRate,\r\n            config.numChannels,\r\n            config.sampleBits\r\n          );\r\n          let blob: any = new Blob([a], { type: 'audio/wav' });\r\n\r\n          blob.arrayBuffer().then((arraybuffer) => {\r\n            Player.play(arraybuffer);\r\n          });\r\n        }, 3000));\r\n    } else {\r\n      recorder.stop();\r\n    }\r\n    this.state.isRecording = true;\r\n    recorder.start().then(\r\n      () => {\r\n        console.log('开始录音');\r\n      },\r\n      (error) => {\r\n        console.log(`异常了,${error.name}:${error.message}`);\r\n      }\r\n    );\r\n  }\r\n\r\n  clearPlay() {\r\n    if (playTimer) {\r\n      clearInterval(playTimer);\r\n      playTimer = null;\r\n    }\r\n    if (drawRecordId) {\r\n      cancelAnimationFrame(drawRecordId);\r\n      drawRecordId = null;\r\n    }\r\n    this.stopDrawPlay();\r\n  }\r\n\r\n  setState(v: any) {}\r\n\r\n  stopDrawPlay = () => {\r\n    drawPlayId && cancelAnimationFrame(drawPlayId);\r\n    drawPlayId = null;\r\n  };\r\n\r\n  collectData() {\r\n    return {\r\n      sampleBits: this.state.sampleBit,\r\n      sampleRate: this.state.sampleRate,\r\n      numChannels: this.state.numChannel,\r\n      compiling: this.state.compiling, // 是否开启边录音边转化（后期改用web worker）\r\n    };\r\n  }\r\n\r\n  //录音停止\r\n  endRecord() {\r\n    recorder && recorder.stop();\r\n    console.log('结束录音');\r\n    drawRecordId && cancelAnimationFrame(drawRecordId);\r\n    drawRecordId = null;\r\n    this.clearPlay();\r\n    this.state.isRecording = false;\r\n    this.saveRecord();\r\n  }\r\n\r\n  recordStartOrStop() {\r\n    if (this.state.isRecording) {\r\n      this.endRecord();\r\n    } else {\r\n      this.startRecord();\r\n    }\r\n  }\r\n\r\n  saveRecord() {\r\n    const wavBlob = recorder.getWAVBlob();\r\n    const a = new FileReader();\r\n    a.onload = (e) => {\r\n      if (e.target.result) {\r\n        this.recordStatusStr = 'Completed';\r\n        this.fileUrlData = e.target.result.toString();\r\n      }\r\n    };\r\n    a.readAsDataURL(wavBlob);\r\n  }\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///"}